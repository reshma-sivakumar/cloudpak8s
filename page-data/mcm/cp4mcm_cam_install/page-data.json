{"componentChunkName":"component---src-pages-mcm-cp-4-mcm-cam-install-index-mdx","path":"/mcm/cp4mcm_cam_install/","result":{"pageContext":{"frontmatter":{"title":"CAM - Installation Guide","weight":500},"relativePagePath":"/mcm/cp4mcm_cam_install/index.mdx","titleType":"page","MdxNode":{"id":"305641c2-dde7-5d3d-8b33-289ac72a443b","children":[],"parent":"163daa68-6476-572f-9c1c-663359ae01e2","internal":{"content":"---\ntitle: \"CAM - Installation Guide\"\nweight: 500\n---\n- \n{:toc}\n\n## Overview\n\n### Prerequisites\n* **OCP 4.0+**\n* **Install CLI Tools**\n  - Helm CLI\n  - Kubernetes CLI\n  - IBM Cloud Pak CLI\n  ```\n  curl -kLo cloudctl https://icp-console.apps.res-cp4mcm.ocp.csplab.local/api/cli/cloudctl-darwin-amd64\n  ```\n  For CLI install help, check out the Knowledge Center guides <a href=\"https://www.ibm.com/support/knowledgecenter/en/SSFC4F_1.2.0/cli/cli_guide_mcm.html\">here</a>.\n\n\n* [Install MCM](/content/mcm/cp4mcm_mcm_install/)\n* **Install Service Catalog** (Required for OCP 4.0+. See install <a href=\"https://docs.openshift.com/container-platform/4.2/applications/service_brokers/installing-service-catalog.html\">here</a>)\n\n## Online Installation\n\n## Offline Installation\n**1.** **Download the install file** from Passport Advantage (PPA):\n\n|         File Name         | Part Number |\n| :-----------------------: | :------ |\n| icp-cam-x86_64-4.1.tar.gz | CC4E1EN | \n\n**2.** **Create SSC policy**\n\n```\noc adm policy add-scc-to-user ibm-anyuid-hostpath-scc system:serviceaccount:services:default\n```\n\n*Note:* Persistent volumes will be needed if you don't have dynamic storage. Visit <a href=\"https://www.ibm.com/support/knowledgecenter/SS2L37_4.1.0.0/cam_create_pv.html\">here</a> for more information.\n\n**3.** **Generate** a deployment **ServiceID API Key** using the following commands:\n```\nexport serviceIDName='service-deploy'\nexport serviceApiKeyName='service-deploy-api-key'\ncloudctl login -a <ibm_cloud_pak_mcm_console_url> --skip-ssl-validation -u <ibm_cloud_pak_mcm_admin_id> -p <ibm_cloud_pak_mcm_admin_password> -n services\ncloudctl iam service-id-create ${serviceIDName} -d 'Service ID for service-deploy'\ncloudctl iam service-policy-create ${serviceIDName} -r Administrator,ClusterAdministrator --service-name 'idmgmt'\ncloudctl iam service-policy-create ${serviceIDName} -r Administrator,ClusterAdministrator --service-name 'identity'\ncloudctl iam service-api-key-create ${serviceApiKeyName} ${serviceIDName} -d 'Api key for service-deploy'\n```\nThe output with the API Key should look something like this: \n```\nName          service-deploy-api-key   \nDescription   Api key for service-deploy   \nBound To      crn:v1:icp:private:iam-identity:mycluster:n/services::serviceid:ServiceId-163c213a-37f5-4f8b-8a3c-2fd7b3887a4f   \nCreated At    2020-01-22T14:46+0000   \nAPI Key       <API KEY HERE>\n```\nSave the API Key for use during install configuration in Step 5b.\n\n**4.** **Load the PPA Archive** (using cloudctl)\n\n**SSH into OpenShift** cluster install box and run the following commands with admin access:\n\n```\nHOST=$(oc get route default-route -n openshift-image-registry --template='{{ .spec.host }}')\ncloudctl login -a <ibm_cloud_pak_mcm_Console_Url> --skip-ssl-validation -u <ibm_cloud_pak_mcm_admin_ID> -p <ibm_cloud_pak_mcm_password> -n services\ndocker login -u <oc admin> -p $(oc whoami -t) $HOST\ncloudctl catalog load-archive --archive icp-cam-[x86-64 | ppc]-4.1.tar.gz --registry $HOST/services\n```\n**5. Install CAM**\n\n**5a. Sync CAM Helm Charts**\n\n1. Login to MCM UI\n2. Sync helm repositories\n3. Go to **Administer** > **Helm repository**\n4. Click **Sync All** in the upper-right corner\n\n**5b. Configure and Install CAM**\n\n1. In upper right-hand corner, click the **Catalog** icon\n2. Search for `ibm-cam` and click the chart from the `local-helm` repository  \n3. Click **Configure** in the bottom-right, or click the **Configuration** tab\n4. Enter the following install parameters:\n   * In the **Configuration** section:\n     - **Release name** - Enter `cam` in release name.\n     - **Target namespace** - From the drop down list, select `services`.\n   * Select **I have read and agreed to license agreements** to accept the license agreements.\n   * In the **Parameters** > **All Parameters** section:\n     - **Worker node architecture** - select amd64\n     - Under **Global** configuration values:\n       - **Docker image pull secret**\n         - For offline installation, set to *default*\n       - **Product Identifier** - Enter `IBMCloudAutomationManager_5737E67_4100_EE_000`\n       - **IAM Service API Key** - Enter the IAM service API Key you created earlier\n       - Optionally, select **Optimize the installation for offline** to optimize the installation for offline. For example, skip internet access to import public starter templates from github.com on the public internet during the installation.\n       - Optionally, select **Enable audit** to enable the audit for actions in Cloud Automation Manager. It requires the management logging service to be installed. For installing the Cloud Automation Manager on IBM Multicloud Manager 3.2.1, select `Enable legacy audit`. For installing the Cloud Automation Manager on IBM Multicloud Manager 3.2.x or higher, select `ICP32`. For audit related installation parameters, see [Installation parameters](https://www.ibm.com/support/knowledgecenter/SS2L37_4.1.0.0/cam_installation_parameters.html?view=kc).\n       - Optionally, select **Enable FIPS for CAM** to enable FIPS.\n     - Under **IBM Cloud Private** > **Port**, enter port value 443, or choose your own port\n     - Under **Image**, set Repository value to `image-registry.openshift-image-registry.svc:5000/services/`\n       - Note: This image registry may vary depending on your cluster (??-JG)\n     - If using Dynamic Storage, Check **Enable Dynamic Provisioning** and set your Storage Class Name. Repeat for each volume.\n\n**5. Confirm Installation**\n\nMonitor your install with \n```\nwatch oc get pods\n```\n\n   You should see something like this:\n\n![CAM Install Pods](/assets/img/cp4mcm/cam_install_pods.png)\n\nOnce complete, access CAM in a browser using the url\n```\noc get routes\n```\n## Additional Resources\n* <a href=\"https://www.ibm.com/support/knowledgecenter/SS2L37_4.1.0.0/cam_prereq.html\">Knowledge Center - CAM Prerequisites</a>\n* <a href=\"https://www.ibm.com/support/knowledgecenter/SS2L37_4.1.0.0/cam_install_offline_icpos.html\">Knowledge Center - CAM Offline Installation Guide</a>\n","type":"Mdx","contentDigest":"238654e711330124265b7bcb7a942071","counter":242,"owner":"gatsby-plugin-mdx"},"frontmatter":{"title":"CAM - Installation Guide","weight":500},"exports":{},"rawBody":"---\ntitle: \"CAM - Installation Guide\"\nweight: 500\n---\n- \n{:toc}\n\n## Overview\n\n### Prerequisites\n* **OCP 4.0+**\n* **Install CLI Tools**\n  - Helm CLI\n  - Kubernetes CLI\n  - IBM Cloud Pak CLI\n  ```\n  curl -kLo cloudctl https://icp-console.apps.res-cp4mcm.ocp.csplab.local/api/cli/cloudctl-darwin-amd64\n  ```\n  For CLI install help, check out the Knowledge Center guides <a href=\"https://www.ibm.com/support/knowledgecenter/en/SSFC4F_1.2.0/cli/cli_guide_mcm.html\">here</a>.\n\n\n* [Install MCM](/content/mcm/cp4mcm_mcm_install/)\n* **Install Service Catalog** (Required for OCP 4.0+. See install <a href=\"https://docs.openshift.com/container-platform/4.2/applications/service_brokers/installing-service-catalog.html\">here</a>)\n\n## Online Installation\n\n## Offline Installation\n**1.** **Download the install file** from Passport Advantage (PPA):\n\n|         File Name         | Part Number |\n| :-----------------------: | :------ |\n| icp-cam-x86_64-4.1.tar.gz | CC4E1EN | \n\n**2.** **Create SSC policy**\n\n```\noc adm policy add-scc-to-user ibm-anyuid-hostpath-scc system:serviceaccount:services:default\n```\n\n*Note:* Persistent volumes will be needed if you don't have dynamic storage. Visit <a href=\"https://www.ibm.com/support/knowledgecenter/SS2L37_4.1.0.0/cam_create_pv.html\">here</a> for more information.\n\n**3.** **Generate** a deployment **ServiceID API Key** using the following commands:\n```\nexport serviceIDName='service-deploy'\nexport serviceApiKeyName='service-deploy-api-key'\ncloudctl login -a <ibm_cloud_pak_mcm_console_url> --skip-ssl-validation -u <ibm_cloud_pak_mcm_admin_id> -p <ibm_cloud_pak_mcm_admin_password> -n services\ncloudctl iam service-id-create ${serviceIDName} -d 'Service ID for service-deploy'\ncloudctl iam service-policy-create ${serviceIDName} -r Administrator,ClusterAdministrator --service-name 'idmgmt'\ncloudctl iam service-policy-create ${serviceIDName} -r Administrator,ClusterAdministrator --service-name 'identity'\ncloudctl iam service-api-key-create ${serviceApiKeyName} ${serviceIDName} -d 'Api key for service-deploy'\n```\nThe output with the API Key should look something like this: \n```\nName          service-deploy-api-key   \nDescription   Api key for service-deploy   \nBound To      crn:v1:icp:private:iam-identity:mycluster:n/services::serviceid:ServiceId-163c213a-37f5-4f8b-8a3c-2fd7b3887a4f   \nCreated At    2020-01-22T14:46+0000   \nAPI Key       <API KEY HERE>\n```\nSave the API Key for use during install configuration in Step 5b.\n\n**4.** **Load the PPA Archive** (using cloudctl)\n\n**SSH into OpenShift** cluster install box and run the following commands with admin access:\n\n```\nHOST=$(oc get route default-route -n openshift-image-registry --template='{{ .spec.host }}')\ncloudctl login -a <ibm_cloud_pak_mcm_Console_Url> --skip-ssl-validation -u <ibm_cloud_pak_mcm_admin_ID> -p <ibm_cloud_pak_mcm_password> -n services\ndocker login -u <oc admin> -p $(oc whoami -t) $HOST\ncloudctl catalog load-archive --archive icp-cam-[x86-64 | ppc]-4.1.tar.gz --registry $HOST/services\n```\n**5. Install CAM**\n\n**5a. Sync CAM Helm Charts**\n\n1. Login to MCM UI\n2. Sync helm repositories\n3. Go to **Administer** > **Helm repository**\n4. Click **Sync All** in the upper-right corner\n\n**5b. Configure and Install CAM**\n\n1. In upper right-hand corner, click the **Catalog** icon\n2. Search for `ibm-cam` and click the chart from the `local-helm` repository  \n3. Click **Configure** in the bottom-right, or click the **Configuration** tab\n4. Enter the following install parameters:\n   * In the **Configuration** section:\n     - **Release name** - Enter `cam` in release name.\n     - **Target namespace** - From the drop down list, select `services`.\n   * Select **I have read and agreed to license agreements** to accept the license agreements.\n   * In the **Parameters** > **All Parameters** section:\n     - **Worker node architecture** - select amd64\n     - Under **Global** configuration values:\n       - **Docker image pull secret**\n         - For offline installation, set to *default*\n       - **Product Identifier** - Enter `IBMCloudAutomationManager_5737E67_4100_EE_000`\n       - **IAM Service API Key** - Enter the IAM service API Key you created earlier\n       - Optionally, select **Optimize the installation for offline** to optimize the installation for offline. For example, skip internet access to import public starter templates from github.com on the public internet during the installation.\n       - Optionally, select **Enable audit** to enable the audit for actions in Cloud Automation Manager. It requires the management logging service to be installed. For installing the Cloud Automation Manager on IBM Multicloud Manager 3.2.1, select `Enable legacy audit`. For installing the Cloud Automation Manager on IBM Multicloud Manager 3.2.x or higher, select `ICP32`. For audit related installation parameters, see [Installation parameters](https://www.ibm.com/support/knowledgecenter/SS2L37_4.1.0.0/cam_installation_parameters.html?view=kc).\n       - Optionally, select **Enable FIPS for CAM** to enable FIPS.\n     - Under **IBM Cloud Private** > **Port**, enter port value 443, or choose your own port\n     - Under **Image**, set Repository value to `image-registry.openshift-image-registry.svc:5000/services/`\n       - Note: This image registry may vary depending on your cluster (??-JG)\n     - If using Dynamic Storage, Check **Enable Dynamic Provisioning** and set your Storage Class Name. Repeat for each volume.\n\n**5. Confirm Installation**\n\nMonitor your install with \n```\nwatch oc get pods\n```\n\n   You should see something like this:\n\n![CAM Install Pods](/assets/img/cp4mcm/cam_install_pods.png)\n\nOnce complete, access CAM in a browser using the url\n```\noc get routes\n```\n## Additional Resources\n* <a href=\"https://www.ibm.com/support/knowledgecenter/SS2L37_4.1.0.0/cam_prereq.html\">Knowledge Center - CAM Prerequisites</a>\n* <a href=\"https://www.ibm.com/support/knowledgecenter/SS2L37_4.1.0.0/cam_install_offline_icpos.html\">Knowledge Center - CAM Offline Installation Guide</a>\n","fileAbsolutePath":"/home/travis/build/ibm-cloud-architecture/cloudpak8s/src/pages/mcm/cp4mcm_cam_install/index.mdx"}}}}