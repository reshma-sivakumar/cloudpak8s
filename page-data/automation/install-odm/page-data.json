{"componentChunkName":"component---src-pages-automation-install-odm-index-mdx","path":"/automation/install-odm/","result":{"pageContext":{"frontmatter":{"title":"Install IBM Operational Decision Manager","weight":1200},"relativePagePath":"/automation/install-odm/index.mdx","titleType":"page","MdxNode":{"id":"d9309c77-ffaf-5d50-a5f1-0fad87fc82d0","children":[],"parent":"8fcf8bd4-2a43-5f8e-bc2f-38878ebcbe23","internal":{"content":"---\ntitle: Install IBM Operational Decision Manager\nweight: 1200\n---\n- \n# make sure there is a space after the - so that the TOC is generated\n{:toc}\n\n**(19.0.3 UPDATE NEEDED)**\n\n### Required services\nBefore installing Operational Decision Manager (ODM), you should have the following pre-requisites in place:\n\n- Have privileged access to your DB2 database server. \n- Optionally, have access to your LDAP directory server.\n\nSee the [Shared services](/content/automation/shared-services) chapter for details on DB2 or LDAP installation, if needed.\n\n### Download the ODM PPA \nDownload the following PPA from [IBM Passport Advantage](https://www.ibm.com/software/passportadvantage) to your working-directory:\n\n- *IBM Cloud Pak for Automation v19.0.1 - Operational Decision Manager for Certified Kubernetes Multiplatform Multilingual (CC223ML)*\n\nThe downloaded archive should be named `ICP4A19.0.1-odm.tgz`.\n\n### Log in to you OCP cluster\nSee the [Prerequisites](/content/automation/pre-requisites) chapter for details on logging in to your OCP cluster.\n\n### Create the ODM project\n- Create a new OpenShift project for ODM with your desired name, e.g. `odmproject`:\n```\noc new-project odmproject\n```\n- Make sure you are working from your newly created ODM project, then grant the tiller server `edit` access to current project:\n```\noc project odmproject\noc adm policy add-role-to-user edit \"system:serviceaccount:tiller:tiller\"\n```\n\n### Update the SCC\n```\noc adm policy add-scc-to-user privileged -z default\n```\n\n### Push the ODM images to the registry\nIf you are installing ODM for the managed cloud, and you are logged in as root, do the following:\n- Login to the Docker registry:\n```\ndocker login -u $(oc whoami) -p $(oc whoami -t) docker-registry.default.svc:5000\n```\n- Download the `loadimages.sh` script to your working directory:\n```\nwget https://raw.githubusercontent.com/icp4a/cert-kubernetes/19.0.1/scripts/loadimages.sh\nchmod +x loadimages.sh\n```\n- Load the images:\n```\n./loadimages.sh -p ICP4A19.0.1-odm.tgz -r docker-registry.default.svc:5000/odmproject\n```\nTo complete above steps, make sure that the port forwarding is properly addressed, see the [Pre-requisites](/content/automation/pre-requisites) chapter for details on the docker registry port forwarding. Otherwise, you might not be able to login to the docker registry, or face timeout during the image push.\n\nIf you are installing ODM for on-prem OCP, and not logged in root, do the following:\n- Login to the Docker registry:\n```\noc -n default get route\n# search for route to docker-registry\nsudo docker login -u $(oc whoami) -p $(oc whoami -t) <route_to_docker_registry>\n```\n- Download the `loadimages.sh` script to your working directory:\n```\nwget https://raw.githubusercontent.com/icp4a/cert-kubernetes/19.0.1/scripts/loadimages.sh\nchmod +x loadimages.sh\n```\n- Load the images:\n```\nsudo ./loadimages.sh -p ICP4A19.0.1-odm.tgz -r <route_to_docker_registry>/odmproject\n```\n\n### Create the ODM database\nThe below step is assumed that external DB2 database is used, if internal database or other types of external databases are used, please refer to the related product documentation.\n\nLog in to the server machine running your DB2 instance, and run the following commands:\n```\nsu - db2inst1\ndb2 create database odmdb automatic storage yes  using codeset UTF-8 territory US pagesize 32768;\ndb2 connect to odmdb\ndb2 list applications\n```\n\n### Create secrets\n\n#### Create an LDAP secret\n- Download the [`ldap-configurations.xml`](/assets/automation/odm/ldap-configurations.xml) and [`webSecurity.xml`](/assets/automation/odm/webSecurity.xml) files to your working directory.\n\n- Update the `ldap-configurations.xml` and `webSecurity.xml` file to replace the ldap host with the public IP address of your LDAP server.\n\n- If needed, you might also update the access info within `webSecurity.xml` file, e.g. to add additional user or group. For the details on how to configure the access info, please refer to the related [ODM knowledge center section](https://www.ibm.com/support/knowledgecenter/en/SSYHZ8_19.0.x/com.ibm.dba.install/k8s_topics/tsk_config_user_access.html).\n\n- Run the following command:\n```\noc create secret generic odm-prod-release-odm-ldap --from-file=ldap-configurations.xml --from-file=webSecurity.xml --type=Opaque\n```\n\n#### Create a BAI Event secret\nIf you plan to use BAI, download the [`plugin-configuration.properties`](/assets/automation/odm/plugin-configuration.properties) file to your working directory and make sure that your BAI Kafka server name is same as the one in `plugin-configuration.properties`, then run the following command:\n```\noc create secret generic odm-prod-release-odm-bai-event --from-file=plugin-configuration.properties\n```\n\n### Install the ODM components\n- Download the [values.yaml](/assets/automation/odm/values.yaml) file to your working directory and update the DB configuration parameters under `externalDatabase` to match your configuration, in particular the IP address for the `serverName` and the `password` for the DB admin account.\n\n- Download the Helm chart to your working directory:\n```\nwget https://github.com/icp4a/cert-kubernetes/raw/19.0.1/ODM/helm-charts/ibm-odm-prod-2.2.0.tgz\n```\n\n- Install the Helm chart:\n```\nhelm install ibm-odm-prod-2.2.0.tgz --name odm-prod-release --namespace odmproject -f values.yaml\n```\n\n### Expose the ODM services\nDownload the [route.yaml](/assets/automation/odm/route.yaml) file to your working directory and run the command:\n```\noc create -f route.yaml\n```\n\nTo retrieve the ODM services URLs, open the `services` section on the OCP cluster console, select the desired ODM service, such as `odm-decisioncenter` and go to the detail page to find the URL. The link will look like:\n```\nhttps://odm-prod-release-odm-decisioncenter-odmproject.cp4a-ocp-6550a99fb8cff23207ccecc2183787a9-0001.us-south.containers.appdomain.cloud/decisioncenter\n```\n\n### Uninstall\nIf needed, run the following steps to uninstall ODM:\n```\nhelm delete odm-prod-release --purge\noc delete secret odm-prod-release-odm-ldap\noc delete secret odm-prod-release-odm-bai-event\noc delete -f route.yaml\n```\n\nPlease note that if this Uninstall is permanent, you might want to clean the related DB2 tables that have been created. For this, please refer to the related [Shared services](./shared-services.md) section for details.\n","type":"Mdx","contentDigest":"9f1aea8b731c481c0dfb51171677f9fc","counter":222,"owner":"gatsby-plugin-mdx"},"frontmatter":{"title":"Install IBM Operational Decision Manager","weight":1200},"exports":{},"rawBody":"---\ntitle: Install IBM Operational Decision Manager\nweight: 1200\n---\n- \n# make sure there is a space after the - so that the TOC is generated\n{:toc}\n\n**(19.0.3 UPDATE NEEDED)**\n\n### Required services\nBefore installing Operational Decision Manager (ODM), you should have the following pre-requisites in place:\n\n- Have privileged access to your DB2 database server. \n- Optionally, have access to your LDAP directory server.\n\nSee the [Shared services](/content/automation/shared-services) chapter for details on DB2 or LDAP installation, if needed.\n\n### Download the ODM PPA \nDownload the following PPA from [IBM Passport Advantage](https://www.ibm.com/software/passportadvantage) to your working-directory:\n\n- *IBM Cloud Pak for Automation v19.0.1 - Operational Decision Manager for Certified Kubernetes Multiplatform Multilingual (CC223ML)*\n\nThe downloaded archive should be named `ICP4A19.0.1-odm.tgz`.\n\n### Log in to you OCP cluster\nSee the [Prerequisites](/content/automation/pre-requisites) chapter for details on logging in to your OCP cluster.\n\n### Create the ODM project\n- Create a new OpenShift project for ODM with your desired name, e.g. `odmproject`:\n```\noc new-project odmproject\n```\n- Make sure you are working from your newly created ODM project, then grant the tiller server `edit` access to current project:\n```\noc project odmproject\noc adm policy add-role-to-user edit \"system:serviceaccount:tiller:tiller\"\n```\n\n### Update the SCC\n```\noc adm policy add-scc-to-user privileged -z default\n```\n\n### Push the ODM images to the registry\nIf you are installing ODM for the managed cloud, and you are logged in as root, do the following:\n- Login to the Docker registry:\n```\ndocker login -u $(oc whoami) -p $(oc whoami -t) docker-registry.default.svc:5000\n```\n- Download the `loadimages.sh` script to your working directory:\n```\nwget https://raw.githubusercontent.com/icp4a/cert-kubernetes/19.0.1/scripts/loadimages.sh\nchmod +x loadimages.sh\n```\n- Load the images:\n```\n./loadimages.sh -p ICP4A19.0.1-odm.tgz -r docker-registry.default.svc:5000/odmproject\n```\nTo complete above steps, make sure that the port forwarding is properly addressed, see the [Pre-requisites](/content/automation/pre-requisites) chapter for details on the docker registry port forwarding. Otherwise, you might not be able to login to the docker registry, or face timeout during the image push.\n\nIf you are installing ODM for on-prem OCP, and not logged in root, do the following:\n- Login to the Docker registry:\n```\noc -n default get route\n# search for route to docker-registry\nsudo docker login -u $(oc whoami) -p $(oc whoami -t) <route_to_docker_registry>\n```\n- Download the `loadimages.sh` script to your working directory:\n```\nwget https://raw.githubusercontent.com/icp4a/cert-kubernetes/19.0.1/scripts/loadimages.sh\nchmod +x loadimages.sh\n```\n- Load the images:\n```\nsudo ./loadimages.sh -p ICP4A19.0.1-odm.tgz -r <route_to_docker_registry>/odmproject\n```\n\n### Create the ODM database\nThe below step is assumed that external DB2 database is used, if internal database or other types of external databases are used, please refer to the related product documentation.\n\nLog in to the server machine running your DB2 instance, and run the following commands:\n```\nsu - db2inst1\ndb2 create database odmdb automatic storage yes  using codeset UTF-8 territory US pagesize 32768;\ndb2 connect to odmdb\ndb2 list applications\n```\n\n### Create secrets\n\n#### Create an LDAP secret\n- Download the [`ldap-configurations.xml`](/assets/automation/odm/ldap-configurations.xml) and [`webSecurity.xml`](/assets/automation/odm/webSecurity.xml) files to your working directory.\n\n- Update the `ldap-configurations.xml` and `webSecurity.xml` file to replace the ldap host with the public IP address of your LDAP server.\n\n- If needed, you might also update the access info within `webSecurity.xml` file, e.g. to add additional user or group. For the details on how to configure the access info, please refer to the related [ODM knowledge center section](https://www.ibm.com/support/knowledgecenter/en/SSYHZ8_19.0.x/com.ibm.dba.install/k8s_topics/tsk_config_user_access.html).\n\n- Run the following command:\n```\noc create secret generic odm-prod-release-odm-ldap --from-file=ldap-configurations.xml --from-file=webSecurity.xml --type=Opaque\n```\n\n#### Create a BAI Event secret\nIf you plan to use BAI, download the [`plugin-configuration.properties`](/assets/automation/odm/plugin-configuration.properties) file to your working directory and make sure that your BAI Kafka server name is same as the one in `plugin-configuration.properties`, then run the following command:\n```\noc create secret generic odm-prod-release-odm-bai-event --from-file=plugin-configuration.properties\n```\n\n### Install the ODM components\n- Download the [values.yaml](/assets/automation/odm/values.yaml) file to your working directory and update the DB configuration parameters under `externalDatabase` to match your configuration, in particular the IP address for the `serverName` and the `password` for the DB admin account.\n\n- Download the Helm chart to your working directory:\n```\nwget https://github.com/icp4a/cert-kubernetes/raw/19.0.1/ODM/helm-charts/ibm-odm-prod-2.2.0.tgz\n```\n\n- Install the Helm chart:\n```\nhelm install ibm-odm-prod-2.2.0.tgz --name odm-prod-release --namespace odmproject -f values.yaml\n```\n\n### Expose the ODM services\nDownload the [route.yaml](/assets/automation/odm/route.yaml) file to your working directory and run the command:\n```\noc create -f route.yaml\n```\n\nTo retrieve the ODM services URLs, open the `services` section on the OCP cluster console, select the desired ODM service, such as `odm-decisioncenter` and go to the detail page to find the URL. The link will look like:\n```\nhttps://odm-prod-release-odm-decisioncenter-odmproject.cp4a-ocp-6550a99fb8cff23207ccecc2183787a9-0001.us-south.containers.appdomain.cloud/decisioncenter\n```\n\n### Uninstall\nIf needed, run the following steps to uninstall ODM:\n```\nhelm delete odm-prod-release --purge\noc delete secret odm-prod-release-odm-ldap\noc delete secret odm-prod-release-odm-bai-event\noc delete -f route.yaml\n```\n\nPlease note that if this Uninstall is permanent, you might want to clean the related DB2 tables that have been created. For this, please refer to the related [Shared services](./shared-services.md) section for details.\n","fileAbsolutePath":"/home/travis/build/ibm-cloud-architecture/cloudpak8s/src/pages/automation/install-odm/index.mdx"}}}}